<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Radiology MCQ Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Rubik&display=swap" rel="stylesheet"/>
    <style>
        /* General Body Styles */
        body {
            font-family: 'Rubik', sans-serif;
            margin: 0;
            overflow-x: hidden; /* Prevent horizontal scrollbar from sidebar */
            background-color: #004d5e; /* Default dark theme background */
            color: #ffffff; /* Default dark theme text color */
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth theme transition */
        }

        /* Light Theme Variables - Adjusted to resemble PrepLadder */
        body.light-theme {
            --bg-color: #e3f2fd; /* Light blue background */
            --container-bg-color: #ffffff; /* White containers */
            --text-color: #212121; /* Dark grey/black text */
            --input-bg-color: #f5f5f5; /* Light grey input background */
            --button-bg-color: #1e88e5; /* Blue button */
            --button-hover-bg-color: #1565c0; /* Darker blue button hover */
            --toggle-color: #1e88e5; /* Blue toggle */
            --sidebar-bg-color: #ffffff; /* White sidebar */
            --sidebar-item-border: 1px solid #e0e0e0; /* Light grey sidebar border */
            --sidebar-item-hover-bg: #bbdefb; /* Light blue sidebar hover */
            --topbar-bg-color: #e3f2fd; /* Light blue topbar */
            --topbar-text-color: #212121; /* Dark text on topbar */
            --profile-field-bg: #f8f8f8; /* Very light grey for profile fields */
        }

        /* Dark Theme Variables */
        body:not(.light-theme) { /* Default to dark if light-theme class is not present */
            --bg-color: #004d5e;
            --container-bg-color: #043f4e;
            --text-color: #ffffff;
            --input-bg-color: #e0f2f1;
            --button-bg-color: #00bcd4;
            --button-hover-bg-color: #0097a7;
            --toggle-color: #81d4fa;
            --sidebar-bg-color: #043f4e;
            --sidebar-item-border: 1px solid #095a71;
            --sidebar-item-hover-bg: #065a73;
            --topbar-bg-color: #002b36;
            --topbar-text-color: #ffffff;
            --profile-field-bg: #095a71;
        }

        /* New Gradient Theme Variables (Subtle Pink to Subtle Blue) */
        body.gradient-theme {
            --bg-color: linear-gradient(to right, #e0e7f7, #f7e0e0); /* Subtle blue to subtle pink gradient */
            --container-bg-color: rgba(255, 255, 255, 0.95); /* Slightly translucent white container */
            --text-color: #333333; /* Dark grey for general text */
            --input-bg-color: #f0f0f0; /* Light grey input */
            --button-bg-color: #6a0dad; /* A purplish blue that looks good on gradient */
            --button-hover-bg-color: #4b0082; /* Darker purple */
            --toggle-color: #6a0dad; /* Purplish blue toggle */
            --sidebar-bg-color: #ffffff; /* White sidebar */
            --sidebar-item-border: 1px solid #e0e0e0;
            --sidebar-item-hover-bg: #f0f8ff; /* Very light blue hover */
            --topbar-bg-color: rgba(255, 255, 255, 0.9); /* Slightly translucent topbar */
            --topbar-text-color: #212121;
            --profile-field-bg: #f8f8f8;
            /* Applying gradient to body background */
            background: var(--bg-color);
        }

        /* Apply theme variables to elements (updated to use var) */
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        .container {
            background-color: var(--container-bg-color);
            color: var(--text-color);
        }
        h1 {
            color: var(--text-color);
        }
        input, select {
            background-color: var(--input-bg-color);
            color: #000;
            border: 1px solid #ced4da;
        }
        button {
            background: var(--button-bg-color);
            color: #fff;
        }
        button:hover {
            background: var(--button-hover-bg-color);
        }
        .toggle {
            color: var(--toggle-color);
        }
        .toggle:hover {
            color: var(--text-color); /* Ensures contrast on hover */
        }
        .topbar {
            background-color: var(--topbar-bg-color);
            color: var(--topbar-text-color);
        }
        .sidebar {
            background-color: var(--sidebar-bg-color);
            color: var(--text-color);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }
        .sidebar-item {
            border-bottom: var(--sidebar-item-border);
        }
        .sidebar-item:hover {
            background-color: var(--sidebar-item-hover-bg);
            color: var(--text-color);
        }
        .dashboard-grid-item {
            color: var(--text-color);
        }
        .dashboard-grid-item:hover {
            color: var(--text-color);
        }
        .welcome-title, .welcome-subtitle {
            color: var(--text-color);
        }
        .profile-field {
            background-color: var(--profile-field-bg);
            color: var(--text-color);
            border: 1px solid #ced4da;
        }
        .profile-field strong {
            color: var(--text-color);
        }
        .settings-option {
            background-color: var(--profile-field-bg);
            color: var(--text-color);
            border: 1px solid #ced4da;
        }
        .settings-option label {
            color: var(--text-color);
        }
        .theme-toggle input[type="radio"] {
            border: 2px solid var(--text-color);
        }
        .theme-toggle input[type="radio"]:checked {
            background-color: var(--button-bg-color);
            border-color: var(--button-bg-color);
        }

        /* Specific Layouts and Components (unchanged from previous styling) */
        .container {
            max-width: 500px;
            margin: 30px auto;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            font-size: 2.0rem;
            font-weight: 500;
            margin-bottom: 25px;
        }
        .input-group {
            margin: 18px 0;
        }
        input, select {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.2s ease-in-out;
        }
        .dashboard {
            display: none;
            text-align: center;
            min-height: 300px;
            padding-top: 50px;
            margin: 0 auto;
            width: 100%;
        }
        .welcome-title {
            text-align: center;
            margin-top: 30px;
            font-size: 2.2rem;
            font-weight: 400;
            color: var(--text-color);
        }
        .welcome-subtitle {
            text-align: center;
            margin-top: 10px;
            font-size: 1.2rem;
            font-weight: 300;
            color: var(--text-color);
            margin-bottom: 30px;
        }
        .sidebar {
            position: fixed;
            top: 50px;
            right: -270px;
            width: 250px;
            height: calc(100% - 50px);
            padding: 20px;
            transition: right 0.2s ease-in-out;
            z-index: 1001;
            overflow-y: auto;
        }
        .sidebar.show {
            right: 0;
        }
        .dashboard-content-wrapper {
            margin: 0 auto;
            padding: 20px;
            width: 90%;
            max-width: 1200px;
            box-sizing: border-box;
        }
        .content-section {
            display: none;
            width: 100%;
            max-width: 900px;
            margin: 25px auto;
            text-align: left;
            line-height: 1.7;
            padding: 20px;
            background-color: var(--container-bg-color);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .mcq-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 30px;
            width: 100%;
        }
        @media (min-width: 768px) {
            .mcq-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .dashboard-grid-item {
                font-size: 1.2rem;
            }
        }
        @media (min-width: 1024px) {
            .mcq-grid {
                grid-template-columns: repeat(3, 1fr);
            }
             .dashboard-grid-item {
                font-size: 1.3rem;
            }
        }
        @media (max-width: 599px) {
            .mcq-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
            .dashboard-grid-item {
                font-size: 1.0rem;
            }
             .welcome-title {
                font-size: 1.8rem;
            }
            .welcome-subtitle {
                font-size: 1.0rem;
            }
        }
        .dashboard-grid-item {
            padding: 20px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            font-size: 1.1rem;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            word-break: break-word;
            line-height: 1.3;
        }
        body:not(.light-theme) .dashboard-grid-item { 
            background: #095a71;
            color: #e0f2f1;
        }
        body:not(.light-theme) .dashboard-grid-item:hover { 
            background: #064a5c;
        }
        body.light-theme .dashboard-grid-item { 
            background: #fff;
            color: #495057;
            border: 1px solid #e0e0e0;
        }
        body.light-theme .dashboard-grid-item:hover { 
            background: #f8f9fa;
        }
        /* Gradient theme specific dashboard items */
        body.gradient-theme .dashboard-grid-item {
            background-color: rgba(255, 255, 255, 0.8); /* Slightly translucent white */
            color: #333333;
            border: 1px solid #e0e0e0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }
        body.gradient-theme .dashboard-grid-item:hover {
            background-color: rgba(255, 255, 255, 0.95);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        .restricted-content {
            display: none; 
            margin-top: 20px;
            padding: 15px;
            background-color: #fce8e6; 
            color: #c0392b; 
            border-radius: 8px;
            border: 1px solid #c0392b;
            text-align: center;
        }
        .subscriber-content {
            margin-top: 20px;
            padding: 15px;
            background-color: #e6f7f0; 
            color: #27ae60; 
            border-radius: 8px;
            border: 1px solid #27ae60;
            text-align: center;
        }
        img {
            position: absolute;
            top: 15px;
            left: 20px;
            height: 120px;
        }
    </style>
</head>
<body>

    <img src="logo.png" alt="Rad Mentor Logo" />

    <div class="container" id="auth-container" style="display: none;">
        <h1>🔬 RadMentor - Login</h1>
        <div class="input-group"><input type="email" id="email" placeholder="Email" /></div>
        <div class="input-group"><input type="password" id="password" placeholder="Password" /></div>
        <button onclick="handleAuth()" id="auth-btn">Sign In</button>
        <div class="toggle" onclick="toggleAuth()">Don't have an account? Sign up</div>
        <p id="auth-message" style="color: #f00; text-align: center; margin-top: 10px;"></p>
    </div>

    <div class="container" id="profile-form" style="display: none;">
        <h1>👤 Complete Your Profile</h1>
        <p style="text-align: center; color: #81d4fa; font-size: 0.9rem;">
            Please complete your profile to continue.
        </p>
        <div class="input-group"><input type="text" id="name" placeholder="Full Name" /></div>
        <div class="input-group"><input type="date" id="dob" /></div>
        <div class="input-group">
            <select id="sex">
                <option value="" disabled selected>Select Sex</option>
                <option>Male</option>
                <option>Female</option>
                <option>Other</option>
            </select>
        </div>
        <div class="input-group">
            <select id="position">
                <option value="" disabled selected>Select Position</option>
                <option>Intern</option>
                <option>Junior Resident</option>
                <option>Senior Resident</option>
                <option>Consultant</option>
            </select>
        </div>
        <div class="input-group">
            <input list="colleges" id="college" placeholder="Medical College" />
            <datalist id="colleges">
                <option value="All India Institute of Medical Sciences, New Delhi">
                <option value="Postgraduate Institute of Medical Education and Research, Chandigarh">
                <option value="Christian Medical College, Vellore">
                <option value="National Institute of Mental Health and Neuro Sciences, Bangalore">
                <option value="Jawaharlal Institute of Postgraduate Medical Education & Research, Puducherry">
                <option value="Amrita Vishwa Vidyapeetham, Coimbatore">
                <option value="Sanjay Gandhi Postgraduate Institute of Medical Sciences, Lucknow">
                <option value="Banaras Hindu University, Varanasi">
                <option value="Kasturba Medical College, Manipal">
                <option value="Sri Ramachandra Institute of Higher Education and Research, Chennai">
                <option value="St. John's Medical College, Bangalore">
                <option value="Aligarh Muslim University, Aligarh">
                <option value="Grant Medical College and Sir J.J. Group of Hospitals, Mumbai">
                <option value="Institute of Liver and Biliary Sciences, New Delhi">
                <option value="Madras Medical College, Chennai">
                <option value="Maulana Azad Medical College, New Delhi">
                <option value="King George's Medical University, Lucknow">
                <option value="Seth G.S. Medical College and K.E.M. Hospital, Mumbai">
                <option value="Vardhman Mahavir Medical College & Safdarjung Hospital, New Delhi">
                <option value="Lady Hardinge Medical College, New Delhi">
                <option value="Armed Forces Medical College, Pune">
                <option value="Lokmanya Tilak Municipal Medical College, Mumbai">
                <option value="BJ Medical College, Ahmedabad">
                <option value="Stanley Medical College, Chennai">
                <option value="Govt. Medical College, Thiruvananthapuram">
                <option value="Osmania Medical College, Hyderabad">
                <option value="Gandhi Medical College, Hyderabad">
                <option value="Bangalore Medical College and Research Institute, Bangalore">
                <option value="Mysore Medical College and Research Institute, Mysore">
                <option value="Dr. B.R. Ambedkar Medical College, Bangalore">
                <option value="J.N. Medical College, Belagavi">
                <option value="Kalinga Institute of Industrial Technology, Bhubaneswar">
                <option value="Mahatma Gandhi Medical College & Research Institute, Puducherry">
                <option value="Datta Meghe Institute of Medical Sciences, Wardha">
                <option value="Saveetha Institute of Medical and Technical Sciences, Chennai">
                <option value="Chettinad Academy of Research and Education, Chennai">
                <option value="M.S. Ramaiah Medical College, Bangalore">
                <option value="Bharati Vidyapeeth (Deemed to be University), Pune">
                <option value="Krishna Institute of Medical Sciences, Karad">
                <option value="Dr. D.Y. Patil Vidyapeeth, Pune">
                <option value="SRM Institute of Science and Technology, Chennai">
                <option value="Manipal University, Jaipur">
                <option value="MGM Medical College, Aurangabad">
                <option value="GITAM, Visakhapatnam">
                <option value="Narayana Medical College, Nellore">
                <option value="KSRM Medical College, Kadapa">
                <option value="Deccan College of Medical Sciences, Hyderabad">
                <option value="Meenakshi Amma Medical College and Hospital, Chennai">
                <option value="MVJ Medical College and Research Hospital, Bangalore">
                <option value="Acharya Institute of Health Sciences, Bangalore">
                <option value="SDM College of Medical Sciences & Hospital, Dharwad">
                <option value="Navodaya Medical College, Raichur">
                <option value="JSS Medical College, Mysore">
                <option value="Rural Medical College, Loni">
                <option value="Pramukhswami Medical College, Anand">
                <option value="Adichunchanagiri Institute of Medical Sciences, Mandya">
                <option value="Vydehi Institute of Medical Sciences and Research Centre, Bangalore">
                <option value="Rajarajeswari Medical College and Hospital, Bangalore">
                <option value="Yenepoya Medical College, Mangaluru">
                <option value="Father Muller Medical College, Mangaluru">
                <option value="Kempegowda Institute of Medical Sciences, Bangalore">
                <option value="Maharaja Agrasen Medical College, Agroha">
                <option value="Christian Medical College, Ludhiana">
                <option value="Mata Gujri Memorial Medical College, Kishanganj">
                <option value="Hi-Tech Medical College & Hospital, Bhubaneswar">
                <option value="Maharishi Markandeshwar (Deemed to be University), Ambala">
                <option value="Teerthanker Mahaveer University, Moradabad">
                <option value="Santosh Medical College and Hospital, Ghaziabad">
                <option value="Sharda University, Greater Noida">
                <option value="Netaji Subhash Chandra Bose Medical College, Jabalpur">
                <option value="Moti Lal Nehru Medical College, Allahabad">
                <option value="Gajra Raja Medical College, Gwalior">
                <option value="S.M.S. Medical College, Jaipur">
                <option value="R.N.T. Medical College, Udaipur">
                <option value="JLN Medical College, Ajmer">
                <option value="Dr. S.N. Medical College, Jodhpur">
                <option value="Government Medical College, Kota">
                <option value="M.P. Shah Medical College, Jamnagar">
                <option value="Government Medical College, Surat">
                <option value="Pt. Deendayal Upadhyay Medical College, Rajkot">
                <option value="Medical College, Baroda">
                <option value="Assam Medical College, Dibrugarh">
                <option value="Gauhati Medical College, Guwahati">
                <option value="Silchar Medical College & Hospital, Silchar">
                <option value="Indira Gandhi Medical College, Shimla">
                <option value="Sher-i-Kashmir Institute of Medical Sciences, Srinagar">
                <option value="Government Medical College, Jammu">
                <option value="King Edward Memorial Hospital and Seth Gordhandas Sunderdas Medical College, Mumbai">
                <option value="BYL Nair Charitable Hospital and Topiwala National Medical College, Mumbai">
                <option value="Seth G.S. Medical College, Mumbai">
                <option value="Lokmanya Tilak Municipal Medical College, Mumbai">
                <option value="BJ Medical College, Pune">
                <option value="Government Medical College, Nagpur">
                <option value="Indira Gandhi Government Medical College, Nagpur">
                <option value="Dr. V. M. Government Medical College, Solapur">
                <option value="Government Medical College, Aurangabad">
                <option value="Grant Medical College, Mumbai">
                <option value="Armed Forces Medical College, Pune">
                <option value="Government Medical College, Akola">
                <option value="Government Medical College, Miraj">
                <option value="Government Medical College, Latur">
                <option value="AIIMS Bhopal">
                <option value="AIIMS Bhubaneswar">
                <option value="AIIMS Jodhpur">
                <option value="AIIMS Patna">
                <option value="AIIMS Raipur">
                <option value="AIIMS Rishikesh">
                <option value="AIIMS Nagpur">
                <option value="AIIMS Mangalagiri">
                <option value="AIIMS Gorakhpur">
                <option value="AIIMS Kalyani">
                <option value="AIIMS Raebareli">
                <option value="AIIMS Bathinda">
                <option value="AIIMS Bilaspur">
                <option value="AIIMS Deoghar">
                <option value="AIIMS Guwahati">
                <option value="AIIMS Rajkot">
                <option value="AIIMS Vijaypur">
                <option value="AIIMS Madurai">
                <option value="AIIMS Darbhanga">
                <option value="AIIMS Rewari">
                <option value="AIIMS Kashmir">
                <option value="AIIMS Jammu">
                <option value="AIIMS Manipur">
                <option value="AIIMS Mizoram">
                <option value="AIIMS Sikkim">
                <option value="AIIMS Tripura">
            </datalist>
        </div>
        <div class="input-group">
            <select id="exam_pursuing">
                <option value="" disabled selected>What exam are you pursuing?</option>
                <option>Final year exam</option>
                <option>DNB</option>
                <option>FRCR</option>
                <option>NEET SS</option>
                <option>INICET SS</option>
                <option>MICR</option>
                <option>Fellowship exams</option>
            </select>
        </div>
        <button onclick="submitProfile()">Submit Profile</button>
    </div>

    <div class="container dashboard" id="dashboard" style="display: none;">
        <div class="topbar">
            <div class="user-greeting">Hi, <span id="user-greeting-name">Doctor</span>!</div>
            <div class="menu-icon" onclick="toggleSidebar()">☰</div>
        </div>

        <div class="sidebar" id="sidebar">
            <div class="sidebar-item" onclick="showDashboardSection('main')">🏠 Home</div>
            <div class="sidebar-item" onclick="showDashboardSection('profile')">👤 Profile</div>
            <div class="sidebar-item" onclick="showDashboardSection('edit-profile')">✏️ Edit Profile</div>
            <div class="sidebar-item" onclick="showDashboardSection('subscription')">💳 Subscription</div>
            <div class="sidebar-item" onclick="showDashboardSection('settings')">⚙️ Settings</div>
            <div class="sidebar-item" onclick="showDashboardSection('about-us')">ℹ️ About Us</div>
            <div class="sidebar-item" onclick="showDashboardSection('contact-us')">📞 Contact Us</div>
            <div class="sidebar-item" onclick="logout()">🚪 Logout</div>
        </div>
        
        <div class="dashboard-content-wrapper" id="dashboard-main-content">
            <h1 class="welcome-title">Welcome to RadMentor</h1>
            <p class="welcome-subtitle">The World’s Most Comprehensive Radiology Learning Source</p>

            <div class="mcq-grid">
                <div class="dashboard-grid-item" onclick="window.location.href='frcr/'">FRCR</div>
                <div class="dashboard-grid-item" onclick="alert('MICR MCQs coming soon!')">MICR</div>
                <div class="dashboard-grid-item" onclick="window.location.href='anatomy/'">Anatomy</div>
                <div class="dashboard-grid-item" onclick="alert('MD / DNB MCQs coming soon!')">MD / DNB</div>
                <div class="dashboard-grid-item" onclick="alert('Superspeciality MCQs coming soon!')">Superspeciality MCQs</div>
                <div class="dashboard-grid-item" onclick="alert('Fellowship Exams MCQs coming soon!')">Fellowship Exams</div>
            </div>
        </div>

        <div class="content-section" id="profile-section">
            <h2>Your Profile</h2>
            <div class="profile-field"><strong>Full Name:</strong> <span id="display-name"></span></div>
            <div class="profile-field"><strong>Date of Birth:</strong> <span id="display-dob"></span></div>
            <div class="profile-field"><strong>Sex:</strong> <span id="display-sex"></span></div>
            <div class="profile-field"><strong>Position:</strong> <span id="display-position"></span></div>
            <div class="profile-field"><strong>Medical College:</strong> <span id="display-college"></span></div>
            <div class="profile-field"><strong>Exam Pursuing:</strong> <span id="display-exam"></span></div>
            <button onclick="showDashboardSection('edit-profile')">Edit Profile</button>
        </div>

        <div class="content-section" id="edit-profile-section">
            <h2>Edit Your Profile</h2>
            <div class="input-group"><input type="text" id="edit-name" placeholder="Full Name" /></div>
            <div class="input-group"><input type="date" id="edit-dob" /></div>
            <div class="input-group">
                <select id="edit-sex">
                    <option value="" disabled selected>Select Sex</option>
                    <option>Male</option>
                    <option>Female</option>
                    <option>Other</option>
                </select>
            </div>
            <div class="input-group">
                <select id="edit-position">
                    <option value="" disabled selected>Select Position</option>
                    <option>Intern</option>
                    <option>Junior Resident</option>
                    <option>Senior Resident</option>
                    <option>Consultant</option>
                </select>
            </div>
            <div class="input-group">
                <input list="colleges" id="edit-college" placeholder="Medical College" />
                <datalist id="colleges"></datalist> 
            </div>
            <div class="input-group">
                <select id="edit-exam-pursuing">
                    <option value="" disabled selected>What exam are you pursuing?</option>
                    <option>Final year exam</option>
                    <option>DNB</option>
                    <option>FRCR</option>
                    <option>NEET SS</option>
                    <option>INICET SS</option>
                    <option>MICR</option>
                    <option>Fellowship exams</option>
                </select>
            </div>
            <button onclick="saveProfileChanges()">Save Changes</button>
            <button onclick="showDashboardSection('profile')" style="background-color: #6c757d; margin-top: 10px;">Cancel</button>
        </div>

        <div class="content-section" id="subscription-section">
            <h2>Subscription</h2>
            <p><strong>Package A:</strong> Basic Access - Monthly MCQs</p>
            <p><strong>Package B:</strong> Premium Access - All MCQs + Mock Tests</p>
            <p><strong>Package C:</strong> Elite Access - All features + Personal Tutoring</p>
            <p>Choose the plan that suits your learning journey! More details and pricing coming soon.</p>
            <button onclick="alert('Navigate to subscription plans page!')" style="background-color: var(--button-bg-color);">View Plans</button>
        </div>

        <div class="content-section" id="settings-section">
            <h2>Settings</h2>
            <div class="settings-option">
                <label>Membership Taken Date:</label>
                <span id="membership-start-date">N/A</span>
            </div>
            <div class="settings-option">
                <label>Membership End Date:</label>
                <span id="membership-end-date">N/A</span>
            </div>
            <div class="settings-option">
                <label>Clear Bookmarks:</label>
                <button onclick="alert('Bookmarks cleared! (Placeholder)')" style="background-color: #dc3545; color: white;">Clear</button>
            </div>
            <div class="settings-option theme-toggle">
                <label for="theme-switch-light">Light Theme</label>
                <input type="radio" id="theme-switch-light" name="theme" value="light" onchange="setTheme('light')">
                <label for="theme-switch-dark">Dark Theme</label>
                <input type="radio" id="theme-switch-dark" name="theme" value="dark" onchange="setTheme('dark')">
                <label for="theme-switch-gradient">Gradient Theme</label> <input type="radio" id="theme-switch-gradient" name="theme" value="gradient" onchange="setTheme('gradient')"> </div>
            <div class="settings-option">
                <label>Notification Preferences:</label>
                <button onclick="alert('Notification settings (Placeholder)')" style="background-color: #007bff; color: white;">Manage</button>
            </div>
            <div class="settings-option">
                <label>Change Password:</label>
                <button onclick="alert('Password change dialog (Placeholder)')" style="background-color: #6c757d; color: white;">Change</button>
            </div>
            <div class="settings-option"> <label>Membership Status:</label>
                <span id="membership-status">N/A</span> </div>
        </div>

        <div class="content-section" id="about-us-section">
            <h2>About Us</h2>
            <p>We are two radiologists trained at one of India’s premier medical institutes, united by a shared vision: to make high-quality radiology education accessible, affordable, and reliable for all.</p>
            <p>In a world where accurate knowledge can shape clinical decisions, we built this platform as a trusted source of learning—for students, residents, and practitioners alike. Every question, explanation, and update is curated by us, backed by evidence, and rooted in real-world radiology practice.</p>
            <p>Whether you're preparing for exams or refining your diagnostic skills, our goal is to support your journey with clear, concise, and clinically relevant content—delivered with the precision you'd expect from radiologists.</p>
            <p>Welcome to a community built by doctors, for doctors.</p>
        </div>

        <div class="content-section" id="contact-us-section">
            <h2>Contact Us</h2>
            <p>Have questions or feedback? We'd love to hear from you!</p>
            <p>Email: <a href="mailto:RadMentor@outlook.com" style="color: var(--toggle-color);">support@radmentor.com</a></p>
            <p>Our team will get back to you as soon as possible.</p>
        </div>

    </div> <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

    <script>
        // Your Firebase Configuration - REPLACE WITH YOUR ACTUAL CONFIGURATION IF DIFFERENT
        const firebaseConfig = {
            apiKey: "AIzaSyD-OTIwv6P88eT2PCPJXiHgZEDgFV8ZcSw", // Your API Key
            authDomain: "radiology-mcqs.firebaseapp.com",
            projectId: "radiology-mcqs",
            storageBucket: "radiology-mcqs.appspot.com",
            messagingSenderId: "862300415358",
            appId: "1:862300415358:web:097d5e413f388e30587f2f",
            measurementId: "G-0V1SD1H95V"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let mode = 'signin'; // Variable to track if we are in sign-in or sign-up mode
        let currentUserData = null; // To store current user's profile data

        // --- Theme Logic ---
        function setTheme(theme) {
            document.body.classList.remove('light-theme', 'gradient-theme'); // Remove all theme classes first
            if (theme === 'light') {
                document.body.classList.add('light-theme');
            } else if (theme === 'gradient') { // Handle new gradient theme
                document.body.classList.add('gradient-theme');
            }
            localStorage.setItem('theme', theme); // Save selected theme
        }

        function setInitialTheme() {
            const savedTheme = localStorage.getItem('theme');
            const lightSwitch = document.getElementById('theme-switch-light');
            const darkSwitch = document.getElementById('theme-switch-dark');
            const gradientSwitch = document.getElementById('theme-switch-gradient'); // New gradient switch

            if (savedTheme === 'light') {
                document.body.classList.add('light-theme');
                if (lightSwitch) lightSwitch.checked = true;
            } else if (savedTheme === 'gradient') { // Handle initial gradient theme load
                document.body.classList.add('gradient-theme');
                if (gradientSwitch) gradientSwitch.checked = true;
            }
            else {
                // Default to dark theme if no preference or explicitly dark
                document.body.classList.remove('light-theme', 'gradient-theme');
                if (darkSwitch) darkSwitch.checked = true;
            }
        }

        // --- Authentication Functions ---
        function toggleAuth() {
            mode = mode === 'signin' ? 'signup' : 'signin';
            document.getElementById('auth-btn').textContent = mode === 'signin' ? 'Sign In' : 'Sign Up';
            document.querySelector('.toggle').textContent = mode === 'signin'
                ? "Don't have an account? Sign up"
                : "Already have an account? Sign in";
            document.getElementById('auth-message').textContent = ''; // Clear message on toggle
        }

        function handleAuth() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const authMessage = document.getElementById('auth-message');
            authMessage.textContent = ''; // Clear previous messages

            if (email === "" || password === "") {
                authMessage.textContent = "Please enter both email and password.";
                return;
            }

            if (mode === 'signin') {
                auth.signInWithEmailAndPassword(email, password)
                    .then(userCredential => {
                        const user = userCredential.user;
                        if (!user.emailVerified) {
                            auth.signOut(); // Log them out immediately
                            authMessage.textContent = "Please verify your email address. Check your inbox for a verification link.";
                            return;
                        }
                        checkUserProfileAndLog(user); // Log login time and access level
                    })
                    .catch(err => {
                        authMessage.textContent = "Sign In Error: " + err.message;
                    });
            } else { // mode === 'signup'
                auth.createUserWithEmailAndPassword(email, password)
                    .then(userCredential => {
                        const user = userCredential.user;
                        return user.sendEmailVerification().then(() => {
                            auth.signOut(); // Log them out immediately after sending verification
                            authMessage.textContent = "Verification email sent! Please verify your email address before signing in.";
                            // Immediately create profile with default restricted access
                            return db.collection('users').doc(user.uid).set({
                                email: user.email,
                                accessLevel: 'restricted', // <--- THIS LINE SETS DEFAULT ACCESS ON SIGNUP
                                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                                name: '', // Name will be filled out on profile form
                                dob: '',
                                sex: '',
                                position: '',
                                college: '',
                                examPursuing: ''
                            });
                        });
                    })
                    .catch(err => {
                        authMessage.textContent = "Sign Up Error: " + err.message;
                    });
            }
        }

        // Function to check user profile, assign default role, and log login
        function checkUserProfileAndLog(user) {
            const userRef = db.collection('users').doc(user.uid);
            userRef.get().then(doc => {
                let userAccessLevel = 'restricted'; // Default if no profile or accessLevel exists
                if (doc.exists) {
                    currentUserData = doc.data(); // Store user data globally
                    if (currentUserData.accessLevel) {
                        userAccessLevel = currentUserData.accessLevel;
                    }
                } else {
                    // This is a new user who just verified their email and is logging in for the first time
                    // or an old user without a profile. Create a basic profile for them.
                    userRef.set({
                        email: user.email,
                        accessLevel: 'restricted', // <--- THIS LINE SETS DEFAULT ACCESS FOR USERS W/O PROFILE
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        name: '', // Name will be filled out on profile form
                        dob: '',
                        sex: '',
                        position: '',
                        college: '',
                        examPursuing: ''
                    }, { merge: true }).then(() => {
                        currentUserData = { email: user.email, accessLevel: 'restricted' };
                    });
                }

                // Log the login event
                db.collection('loginLogs').add({
                    userId: user.uid,
                    email: user.email,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    accessLevel: userAccessLevel
                }).then(() => {
                    console.log("Login event logged for user:", user.email, "Access:", userAccessLevel);
                }).catch(logErr => {
                    console.error("Error logging login event:", logErr);
                });

                // Now proceed based on profile existence
                if (doc.exists && doc.data().name) { // Check if profile exists and name is filled
                    loadDashboard(doc.data().name, userAccessLevel);
                } else {
                    document.getElementById('auth-container').style.display = 'none';
                    document.getElementById('profile-form').style.display = 'block';
                }
            }).catch(error => {
                console.error("Error checking user profile or logging in:", error);
                alert("An error occurred. Please try again.");
            });
        }

        // Firebase Auth State Observer: This runs every time the user's login state changes
        auth.onAuthStateChanged(user => {
            // Hide all sections initially
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('profile-form').style.display = 'none';
            document.getElementById('dashboard').style.display = 'none';
            document.querySelector('.topbar').style.display = 'none';
            document.getElementById('sidebar').classList.remove('show'); 

            if (user) {
                if (!user.emailVerified) {
                    auth.signOut(); // Log them out if email not verified
                    document.getElementById('auth-container').style.display = 'block';
                    document.getElementById('auth-message').textContent = "Your email is not verified. Please check your inbox for a verification link.";
                    return;
                }
                // If email is verified, proceed to check profile and access
                checkUserProfileAndLog(user);
            } else {
                // No user is logged in -> show authentication container
                document.getElementById('auth-container').style.display = 'block';
            }
        });

        // Function to submit the user's profile data
        function submitProfile() {
            const user = auth.currentUser;
            if (!user) {
                alert("No user logged in. Please sign in first.");
                return;
            }

            const profileData = {
                name: document.getElementById('name').value,
                dob: document.getElementById('dob').value,
                sex: document.getElementById('sex').value,
                position: document.getElementById('position').value,
                college: document.getElementById('college').value,
                examPursuing: document.getElementById('exam_pursuing').value,
                // Do not overwrite accessLevel or createdAt if already set by initial signup
            };

            // Basic validation
            if (!profileData.name || !profileData.dob || !profileData.sex || !profileData.position || !profileData.college || !profileData.examPursuing) {
                alert("Please fill in all profile fields.");
                return;
            }

            db.collection('users').doc(user.uid).update(profileData) // Use update to merge, not overwrite
                .then(() => {
                    // Update currentUserData with new profile info
                    currentUserData = { ...currentUserData, ...profileData }; 
                    document.getElementById('profile-form').style.display = 'none';
                    loadDashboard(currentUserData.name, currentUserData.accessLevel);
                })
                .catch(err => alert("Error saving profile: " + err.message));
        }

        // Function to load the dashboard and display content based on access level
        function loadDashboard(userName = "Doctor", accessLevel = "restricted") {
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('profile-form').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.querySelector('.topbar').style.display = 'flex';
            
            document.getElementById('user-greeting-name').textContent = userName;

            // Show main dashboard content by default
            showDashboardSection('main'); 

            // Display restricted/subscriber messages
            const restrictedMessageDiv = document.createElement('div');
            restrictedMessageDiv.className = 'restricted-content';
            restrictedMessageDiv.innerHTML = '<p>You have restricted access. Some content may not be available. Please subscribe for full access.</p><button onclick="showDashboardSection(\'subscription\')">View Subscription Plans</button>';

            const subscriberMessageDiv = document.createElement('div');
            subscriberMessageDiv.className = 'subscriber-content';
            subscriberMessageDiv.innerHTML = '<p>You have full subscriber access! Enjoy all features.</p>';

            const dashboardContent = document.getElementById('dashboard-main-content');
            
            // Clear previous messages if any
            dashboardContent.querySelectorAll('.restricted-content, .subscriber-content').forEach(el => el.remove());

            if (accessLevel === 'restricted') {
                dashboardContent.appendChild(restrictedMessageDiv);
            } else if (accessLevel === 'subscriber') {
                dashboardContent.appendChild(subscriberMessageDiv);
            }

            // Example: Restrict certain buttons based on accessLevel
            document.querySelectorAll('.mcq-grid .dashboard-grid-item').forEach(item => {
                const feature = item.textContent.trim(); 
                if (accessLevel === 'restricted' && (feature === 'FRCR' || feature === 'MICR' || feature === 'Superspeciality MCQs' || feature === 'Fellowship Exams')) {
                     item.style.opacity = '0.5';
                     item.style.pointerEvents = 'none';
                     item.onclick = () => alert('This content is for subscribers only. Please subscribe to unlock!');
                } else {
                    item.style.opacity = '1';
                    item.style.pointerEvents = 'auto';
                    // Re-assign original onclick from HTML based on initial setup
                    if (feature === 'FRCR') item.onclick = () => window.location.href='frcr/';
                    else if (feature === 'Anatomy') item.onclick = () => window.location.href='anatomy/';
                    else if (feature === 'MICR') item.onclick = () => alert('MICR MCQs coming soon!');
                    else if (feature === 'MD / DNB') item.onclick = () => alert('MD / DNB MCQs coming soon!');
                    else if (feature === 'Superspeciality MCQs') item.onclick = () => alert('Superspeciality MCQs coming soon!');
                    else if (feature === 'Fellowship Exams') item.onclick = () => alert('Fellowship Exams MCQs coming soon!');

                }
            });
        }

        function logout() {
            auth.signOut().then(() => {
                console.log("User signed out.");
                currentUserData = null; // Clear global user data on logout
            }).catch(error => {
                alert("Error signing out: " + error.message);
            });
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('show');
        }

        function showDashboardSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById('dashboard-main-content').style.display = 'none';

            if (sectionId === 'main') {
                document.getElementById('dashboard-main-content').style.display = 'flex'; 
            } else if (sectionId === 'profile') {
                populateProfileDetails(); 
                document.getElementById('profile-section').style.display = 'block';
            } else if (sectionId === 'edit-profile') {
                populateEditProfileForm(); 
                document.getElementById('edit-profile-section').style.display = 'block';
            } else if (sectionId === 'subscription') {
                document.getElementById('subscription-section').style.display = 'block';
            } else if (sectionId === 'settings') {
                populateSettings(); 
                document.getElementById('settings-section').style.display = 'block';
            } else if (sectionId === 'about-us') {
                document.getElementById('about-us-section').style.display = 'block';
            } else if (sectionId === 'contact-us') {
                document.getElementById('contact-us-section').style.display = 'block';
            }
            
            document.getElementById('sidebar').classList.remove('show');
        }

        function populateProfileDetails() {
            if (currentUserData) {
                document.getElementById('display-name').textContent = currentUserData.name || 'N/A';
                const dob = currentUserData.dob;
                if (dob) {
                    try {
                        const dateObj = new Date(dob);
                        document.getElementById('display-dob').textContent = dateObj.toLocaleDateString('en-GB', { day: '2-digit', month: 'long', year: 'numeric' });
                    } catch (e) {
                        document.getElementById('display-dob').textContent = dob; 
                    }
                } else {
                    document.getElementById('display-dob').textContent = 'N/A';
                }

                document.getElementById('display-sex').textContent = currentUserData.sex || 'N/A';
                document.getElementById('display-position').textContent = currentUserData.position || 'N/A';
                document.getElementById('display-college').textContent = currentUserData.college || 'N/A';
                document.getElementById('display-exam').textContent = currentUserData.examPursuing || 'N/A';
                document.getElementById('membership-status').textContent = currentUserData.accessLevel ? currentUserData.accessLevel.toUpperCase() : 'N/A';

            }
        }

        function populateSettings() {
            document.getElementById('membership-start-date').textContent = "Not yet subscribed"; 
            document.getElementById('membership-end-date').textContent = "Not yet subscribed"; 
            if (currentUserData && currentUserData.accessLevel) {
                 document.getElementById('membership-status').textContent = currentUserData.accessLevel ? currentUserData.accessLevel.toUpperCase() : 'N/A'; // Ensure access level is shown
                 if (currentUserData.accessLevel === 'subscriber') {
                     document.getElementById('membership-start-date').textContent = "Jan 1, 2025 (Example)";
                     document.getElementById('membership-end-date').textContent = "Jan 1, 2026 (Example)";
                 }
            }
            setInitialTheme();
        }

        setInitialTheme();
    </script>
</body>
</html>
