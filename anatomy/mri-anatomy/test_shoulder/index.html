<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Shoulder MRI Viewer</title>
  <script src="https://unpkg.com/cornerstone-core"></script>
  <script src="https://unpkg.com/cornerstone-tools"></script>
  <script src="https://unpkg.com/dicom-parser"></script>
  <script src="https://unpkg.com/cornerstone-wado-image-loader"></script>
  <style>
    #dicomImage {
      width: 512px;
      height: 512px;
      background-color: black;
    }
  </style>
</head>
<body>
  <div id="dicomImage"></div>
  <script>
    // Link Cornerstone and WADO loader
    cornerstoneWADOImageLoader.external.cornerstone = cornerstone;

    // Enable the element
    const element = document.getElementById('dicomImage');
    cornerstone.enable(element);

    // Generate the list of all 280 slice URLs
    const baseUrl = "https://raw.githubusercontent.com/im2famous4u/RadMentor/main/anatomy/mri-anatomy/test_shoulder/";
    const imageIds = [];
    for (let i = 1; i <= 280; i++) {
      const num = String(i).padStart(4, '0'); // IMG0001 format
      imageIds.push(`wadouri:${baseUrl}IMG${num}.dcm`);
    }

    let currentImageIndex = 0;

    // Function to display the current image
    function loadAndViewImage(index) {
      const imageId = imageIds[index];
      cornerstone.loadAndCacheImage(imageId).then(function(image) {
        cornerstone.displayImage(element, image);
      }).catch(err => console.error(err));
    }

    // Initial load
    loadAndViewImage(currentImageIndex);

    // Auto-play through all images once
    let playInterval = setInterval(() => {
      currentImageIndex++;
      if (currentImageIndex >= imageIds.length) {
        clearInterval(playInterval);
      } else {
        loadAndViewImage(currentImageIndex);
      }
    }, 100); // 100 ms per slice
  </script>
</body>
</html>
